{% extends 'base.html' %}

{% block content %}
  <h1 class="text-3xl font-bold mb-4">My Dashboard</h1>
  <h2 class="text-2xl font-bold mb-2">My Surveys</h2>
  <ul class="space-y-4">
    {% for survey in surveys %}
      <li class="bg-white shadow-md rounded p-4 flex flex-col justify-between">
        <div>
          <h3 class="text-xl font-bold">{{ survey.title }}</h3>
          <p class="text-gray-600">{{ survey.description }}</p>
        </div>
        <div class="space-x-2 mt-4">
          <a href="{% url 'create_question' survey.pk %}" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Questions</a>
          <a href="{% url 'survey_responses' survey.pk %}" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Responses</a>
          <button onclick="copyToClipboard(`{% url 'take_survey' survey.pk %}`)" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Share</button>
          <a href="{% url 'delete_survey' survey.pk %}" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Delete</a>
        </div>
      </li>
    {% endfor %}
  </ul>
  <h2 class="text-2xl font-bold mb-2 mt-4">Take a Survey</h2>
  <form class="flex space-x-2">
    <input type="text" id="survey-link" placeholder="Enter survey link" class="p-2 border border-gray-400 rounded">
    <button type="button" onclick="takeSurvey()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Take Survey</button>
  </form>
  <div class="mt-4">
    <a href="{% url 'create_survey' %}" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Create a New Survey</a>
  </div>

  <script>
    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(function() {
        alert('Survey link copied to clipboard!');
      }, function(err) {
        alert('Failed to copy survey link to clipboard.');
      });
    }

    function takeSurvey() {
      const surveyLink = document.getElementById('survey-link').value;
      window.location.href = surveyLink;
    }
  </script>
{% endblock %}